
#define RC_TOTAL	32
#define RC_LENGTH	6


// #define STATE_SEED0 0
// #define STATE_SEED1 1
// #define STATE_SEED2 2
// #define STATE_SEED3 3
// #define STATE_SEED4 4
// #define STATE_SEED5 5
// #define STATE_SEED6 6
// #define STATE_SEED7 7
// #define STATE_SEED8 8
// #define STATE_SEED9 9
// #define STATE_SEED10 10
// #define STATE_SEED11 11
// #define STATE_SEED12 12
// #define STATE_SEED13 13
// #define STATE_SEED14 14
// #define STATE_SEED15 15
// #define STATE_SEED16 16
// #define STATE_SEED17 17
// #define STATE_SEED18 18
// #define STATE_SEED19 19
// #define STATE_SEED20 20
// #define STATE_SEED21 21
// #define STATE_SEED22 22
// #define STATE_SEED23 23
// #define STATE_SEED24 24
// #define STATE_SEED25 25
// #define STATE_SEED26 26
// #define STATE_SEED27 27
// #define STATE_SEED28 28
// #define STATE_SEED29 29
// #define STATE_SEED30 30
// #define STATE_SEED31 31
// #define STATE_SEED32 32
// #define STATE_SEED33 33
// #define STATE_SEED34 34
// #define STATE_SEED35 35
// #define STATE_SEED36 36
// #define STATE_SEED37 37
// #define STATE_SEED38 38
// #define STATE_SEED39 39
// #define STATE_SEED40 40
// #define STATE_SEED41 41
// #define STATE_SEED42 42
// #define STATE_SEED43 43
// #define STATE_SEED44 44
// #define STATE_SEED45 45
// #define STATE_SEED46 46
// #define STATE_SEED47 47
// #define STATE_SEED48 48
// #define STATE_SEED49 49
// #define STATE_SEED50 50
// #define STATE_SEED51 51
// #define STATE_SEED52 52
// #define STATE_SEED53 53
// #define STATE_SEED54 54
// #define STATE_SEED55 55
// #define STATE_SEED56 56
// #define STATE_SEED57 57
// #define STATE_SEED58 58
// #define STATE_SEED59 59
// #define STATE_SEED60 60
// #define STATE_SEED61 61
// #define STATE_SEED62 62
// #define STATE_SEED63 63

// #define STATE_SEED0 (0x1)
// #define STATE_SEED1 (0x0)
// #define STATE_SEED2 (0x1)
// #define STATE_SEED3 (0x0)
// #define STATE_SEED4 (0x1)

#define STATE_SEED0 (0x0)
#define STATE_SEED1 (0x0)
#define STATE_SEED2 (0x0)
#define STATE_SEED3 (0x0)
#define STATE_SEED4 (0x0)
#define STATE_SEED5 (0x0)
#define STATE_SEED6 (0x0)
#define STATE_SEED7 (0x0)
#define STATE_SEED8 (0x0)
#define STATE_SEED9 (0x0)
#define STATE_SEED10 (0x0)
#define STATE_SEED11 (0x0)
#define STATE_SEED12 (0x0)
#define STATE_SEED13 (0x0)
#define STATE_SEED14 (0x0)
#define STATE_SEED15 (0x0)
#define STATE_SEED16 (0x0)
#define STATE_SEED17 (0x0)
#define STATE_SEED18 (0x0)
#define STATE_SEED19 (0x0)
#define STATE_SEED20 (0x0)
#define STATE_SEED21 (0x0)
#define STATE_SEED22 (0x0)
#define STATE_SEED23 (0x0)
#define STATE_SEED24 (0x0)
#define STATE_SEED25 (0x0)
#define STATE_SEED26 (0x0)
#define STATE_SEED27 (0x0)
#define STATE_SEED28 (0x0)
#define STATE_SEED29 (0x0)
#define STATE_SEED30 (0x0)
#define STATE_SEED31 (0x0)
#define STATE_SEED32 (0x0)
#define STATE_SEED33 (0x0)
#define STATE_SEED34 (0x0)
#define STATE_SEED35 (0x0)
#define STATE_SEED36 (0x0)
#define STATE_SEED37 (0x0)
#define STATE_SEED38 (0x0)
#define STATE_SEED39 (0x0)
#define STATE_SEED40 (0x0)
#define STATE_SEED41 (0x0)
#define STATE_SEED42 (0x0)
#define STATE_SEED43 (0x0)
#define STATE_SEED44 (0x0)
#define STATE_SEED45 (0x0)
#define STATE_SEED46 (0x0)
#define STATE_SEED47 (0x0)
#define STATE_SEED48 (0x0)
#define STATE_SEED49 (0x0)
#define STATE_SEED50 (0x0)
#define STATE_SEED51 (0x0)
#define STATE_SEED52 (0x0)
#define STATE_SEED53 (0x0)
#define STATE_SEED54 (0x0)
#define STATE_SEED55 (0x0)
#define STATE_SEED56 (0x0)
#define STATE_SEED57 (0x0)
#define STATE_SEED58 (0x0)
#define STATE_SEED59 (0x0)
#define STATE_SEED60 (0x0)
#define STATE_SEED61 (0x0)
#define STATE_SEED62 (0x0)
#define STATE_SEED63 (0x0)


#define KEY_SEED0 (0x0)
#define KEY_SEED1 (0x0)
#define KEY_SEED2 (0x0)
#define KEY_SEED3 (0x0)
#define KEY_SEED4 (0x0)
#define KEY_SEED5 (0x0)
#define KEY_SEED6 (0x0)
#define KEY_SEED7 (0x0)
#define KEY_SEED8 (0x0)
#define KEY_SEED9 (0x0)
#define KEY_SEED10 (0x0)
#define KEY_SEED11 (0x0)
#define KEY_SEED12 (0x0)
#define KEY_SEED13 (0x0)
#define KEY_SEED14 (0x0)
#define KEY_SEED15 (0x0)
#define KEY_SEED16 (0x0)
#define KEY_SEED17 (0x0)
#define KEY_SEED18 (0x0)
#define KEY_SEED19 (0x0)
#define KEY_SEED20 (0x0)
#define KEY_SEED21 (0x0)
#define KEY_SEED22 (0x0)
#define KEY_SEED23 (0x0)
#define KEY_SEED24 (0x0)
#define KEY_SEED25 (0x0)
#define KEY_SEED26 (0x0)
#define KEY_SEED27 (0x0)
#define KEY_SEED28 (0x0)
#define KEY_SEED29 (0x0)
#define KEY_SEED30 (0x0)
#define KEY_SEED31 (0x0)
#define KEY_SEED32 (0x0)
#define KEY_SEED33 (0x0)
#define KEY_SEED34 (0x0)
#define KEY_SEED35 (0x0)
#define KEY_SEED36 (0x0)
#define KEY_SEED37 (0x0)
#define KEY_SEED38 (0x0)
#define KEY_SEED39 (0x0)
#define KEY_SEED40 (0x0)
#define KEY_SEED41 (0x0)
#define KEY_SEED42 (0x0)
#define KEY_SEED43 (0x0)
#define KEY_SEED44 (0x0)
#define KEY_SEED45 (0x0)
#define KEY_SEED46 (0x0)
#define KEY_SEED47 (0x0)
#define KEY_SEED48 (0x0)
#define KEY_SEED49 (0x0)
#define KEY_SEED50 (0x0)
#define KEY_SEED51 (0x0)
#define KEY_SEED52 (0x0)
#define KEY_SEED53 (0x0)
#define KEY_SEED54 (0x0)
#define KEY_SEED55 (0x0)
#define KEY_SEED56 (0x0)
#define KEY_SEED57 (0x0)
#define KEY_SEED58 (0x0)
#define KEY_SEED59 (0x0)
#define KEY_SEED60 (0x0)
#define KEY_SEED61 (0x0)
#define KEY_SEED62 (0x0)
#define KEY_SEED63 (0x0)

#define STATE_SIZE 64
#define KEY_SIZE 64
#define NIBBLE_SIZE 4
#define M0 0x4
#define M1 0x1
#define M2 0x2
#define M3 0x2
#define M4 0x8
#define M5 0x6
#define M6 0x5
#define M7 0x6
#define M8 0xB
#define M9 0xE
#define M10 0xA
#define M11 0x9
#define M12 0x2
#define M13 0x2
#define M14 0xF
#define M15 0xB

#define A 	0	
#define B 	1
#define C 	2
#define D 	3

#define RC0 0x01
#define RC1 0x03
#define RC2 0x07
#define RC3 0x0F
#define RC4 0x1F
#define RC5 0x3E
#define RC6 0x3D
#define RC7 0x3B
#define RC8 0x37
#define RC9 0x2F
#define RC10 0x1E
#define RC11 0x3C
#define RC12 0x39
#define RC13 0x33
#define RC14 0x27
#define RC15 0x0E
#define RC16 0x1D
#define RC17 0x3A
#define RC18 0x35
#define RC19 0x2B
#define RC20 0x16
#define RC21 0x2C
#define RC22 0x18
#define RC23 0x30
#define RC24 0x21
#define RC25 0x02
#define RC26 0x05
#define RC27 0x0B
#define RC28 0x17
#define RC29 0x2E
#define RC30 0x1C
#define RC31 0x38



uint8_t state[ STATE_SIZE ] = { STATE_SEED63, STATE_SEED62, STATE_SEED61, STATE_SEED60, 
                                STATE_SEED59, STATE_SEED58, STATE_SEED57, STATE_SEED56, 
                                STATE_SEED55, STATE_SEED54, STATE_SEED53, STATE_SEED52,
                                STATE_SEED51, STATE_SEED50, STATE_SEED49, STATE_SEED48, 

                                STATE_SEED47, STATE_SEED46, STATE_SEED45, STATE_SEED44, 
                                STATE_SEED43, STATE_SEED42, STATE_SEED41, STATE_SEED40,
                                STATE_SEED39, STATE_SEED38, STATE_SEED37, STATE_SEED36,
                                STATE_SEED35, STATE_SEED34, STATE_SEED33, STATE_SEED32,

                                STATE_SEED31, STATE_SEED30, STATE_SEED29, STATE_SEED28,
                                STATE_SEED27, STATE_SEED26, STATE_SEED25, STATE_SEED24,
                                STATE_SEED23, STATE_SEED22, STATE_SEED21, STATE_SEED20,
                                STATE_SEED19, STATE_SEED18, STATE_SEED17, STATE_SEED16,

                                STATE_SEED15, STATE_SEED14, STATE_SEED13, STATE_SEED12,
                                STATE_SEED11, STATE_SEED10, STATE_SEED9, STATE_SEED8,
                                STATE_SEED7, STATE_SEED6, STATE_SEED5, STATE_SEED4,
                                STATE_SEED3, STATE_SEED2, STATE_SEED1, STATE_SEED0 };

uint8_t key[ KEY_SIZE ] = { KEY_SEED63, KEY_SEED62, KEY_SEED61, KEY_SEED60,
                            KEY_SEED59, KEY_SEED58, KEY_SEED57, KEY_SEED56, 
                            KEY_SEED55, KEY_SEED54, KEY_SEED53, KEY_SEED52,
                            KEY_SEED51, KEY_SEED50, KEY_SEED49, KEY_SEED48,
                            KEY_SEED47, KEY_SEED46, KEY_SEED45, KEY_SEED44,
                            KEY_SEED43, KEY_SEED42, KEY_SEED41, KEY_SEED40, 
                            KEY_SEED39, KEY_SEED38, KEY_SEED37, KEY_SEED36,
                            KEY_SEED35, KEY_SEED34, KEY_SEED33, KEY_SEED32,
                            KEY_SEED31, KEY_SEED30, KEY_SEED29, KEY_SEED28,
                            KEY_SEED27, KEY_SEED26, KEY_SEED25, KEY_SEED24,
                            KEY_SEED23, KEY_SEED22, KEY_SEED21, KEY_SEED20,
                            KEY_SEED19, KEY_SEED18, KEY_SEED17, KEY_SEED16, 
                            KEY_SEED15, KEY_SEED14, KEY_SEED13, KEY_SEED12,
                            KEY_SEED11, KEY_SEED10, KEY_SEED9, KEY_SEED8,
                            KEY_SEED7, KEY_SEED6, KEY_SEED5, KEY_SEED4,
                            KEY_SEED3, KEY_SEED2, KEY_SEED1, KEY_SEED0 };
uint8_t *mds;
uint8_t mds_std[ 16 ] = {   M0, M1, M2, M3,
                        M4, M5, M6, M7,
                        M8, M9, M10, M11,
                        M12, M13, M14, M15 
                    };
uint8_t **RC;
uint8_t RC_std[RC_TOTAL] = { RC0, RC1, RC2, RC3, RC4, RC5, RC6, RC7,
                    RC8, RC9, RC10, RC11, RC12, RC13, RC14, RC15,
                    RC16, RC17, RC18, RC19, RC20, RC21, RC22, RC23, 
                    RC24, RC25, RC26, RC27, RC28, RC29, RC30, RC31 };

uint8_t *KEY_SIZE_CNS;


uint8_t sbox_1(uint8_t *input);
uint8_t sbox_2(uint8_t *input);
uint8_t sbox_3(uint8_t *input);
uint8_t sbox_4(uint8_t *input);

void subCells(uint8_t *curr_state);
uint8_t** generate_sub_keys(uint8_t *key, int rounds);
uint8_t* generate_sub_key(uint8_t* key, int rnd);
uint8_t* reverse_nibbles(uint8_t *array, int start, int end);
uint8_t* rotate(uint8_t *state, int shift,int size);
uint8_t* shiftRow(uint8_t *state);
uint8_t *AND(uint8_t *a, uint8_t *b, int size);
void initState();
void init_mds();
void init_RC();
void addConstants(uint8_t *state, int round);
void run();
uint8_t gf28_mul( uint8_t a, uint8_t b );
uint8_t *gm_bs(uint8_t *a, uint8_t *b);
uint8_t gm(uint8_t a, uint8_t b);
void mixColumnsSerial(uint8_t *curr_state);
void step(uint8_t *state, int round);
void addRoundKey(uint8_t *state, uint8_t *r_key);

/*testing*/
void tests();
void shift_row_test();
void run_led_tests();
void gm_bs_test();
